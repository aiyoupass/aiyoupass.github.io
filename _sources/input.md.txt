# How to write INPUT file
## INPUT文件
INPUT文件控制计算的所有设置, 以及一些必要的输入数据.
这个文件实际上遵守的是`.toml`格式, 所以用户写INPUT时必须遵守`.toml`的语法规则.

比如容易引起错误的是，一个list（如[1, 2, 5]）的元素之间必须用逗号隔开，而且元素必须是一样的数据类型，比如不能有一个元素是浮点数，另一个是整数.

程序提供了很多参数，可以设置，但是大部分参数都有默认值，用户可以不设置，程序会使用该参数的默认值.

作为一个计算非线性光学的程序，我们无法从第一性原理出现直接计算体系，必须依赖于其它第一性原理计算软件的输出，比如VASP, Wannier90等.另外我们还有另一种直接从模型哈密顿量出发的计算方式，需要提供模型哈密顿量的构造方式。

## wannier90接口
wannier90采用正交的原子轨道基。
### 所需数据
我们用参数 W90_INPUT_DATA_SOURCE 控制从哪里文件读取wannier90的输出数据.
该参数的默认值为`W90_INPUT_DATA_SOURCE=[1, 2, 3]`. 即哈密顿量矩阵从 `seedname_tb.dat`中获取，位置算符矩阵从`AAR.dat`中获取，wannier centres从`seedname_wout.dat`中获取.

接下来我会详细介绍这三个文件中的数据的物理意义和相关问题.
#### 哈密顿量矩阵

以Wannier函数为基的计算方法具有清晰的物理图像：每个cell包含若干原子轨道，每个轨道对应一个Wannier函数。由于原子轨道具有局域性，因此只需要考虑一个轨道与其邻近轨道（包括同一cell和其他cell的轨道）之间的相互作用，即可充分描述整个体系。


我们用$R_n$表示系统R位置处的CELL的第n个轨道的wannier函数.
那哈密顿量矩阵$<On|H|Rm>$的物理含义就是两个位置差为R的cell中n和m轨道的相互作用。

这个数据可以在wannier90的正式输出文件seedname_hr.dat/seedname_tb.dat中找到.由参数`write_hr`和`write_tb`控制.

具体数据如何在这两个文件中被组织请看wannier90的官方文档.

目前没有证据表明两个文件中的数据会有不一致的情况，但是数据精度会有差别。
#### 位置算符矩阵
即$<On|r|R>$，大概可以表示两个轨道的重叠程度.

这个数据可以在wannier90的正式输出文件seedname_tb.dat中找到.另外我们还可以从AAR.dat中获取.

之所以我选择从AAR.dat中获取，是因为在我们的计算中，seedname_tb.dat中提供的位置矩阵数据并不总是正确，所以以AAR.dat中的数据作为代替。

我提供的一个例子是单层MoS2体系, 具体见`example1/`文件夹.
#### wannier centres
实际上就是$<On|r|On>$，即轨道n对应的wannier 函数在cell中的期望位置.明显的是，一个原子的多个轨道的wannier centres应当分布在这个原子的位置周围.

$<On|r|On>$实际上就是位置算符矩阵$<On|r|R>$的一个子集。我们提供了四种方式来获取这个数据，分别是从seedname_tb.dat, AAR.dat, seedname_wout.dat和POSCAR文件.

前两者在位置算符矩阵中已经提到了，后两者的物理意义也很明显，WOUT中给出了最大局域化后的Wannier函数的wannier centres。而POSCAR文件中给出了原子的位置，我们当然可以用原子的位置模拟轨道的位置.

事实上围绕这个数据，出现了一些非常诡异的现象导致很多奇怪的结果错误。所以我们现在最信任的是WOUT的数据。后面我们将在example中详细介绍这些错误。 

### 体系的微调
#### SOC_TO_NONSOC
#### 删除cell间某方向的相互作用
#### 构造超胞
#### 调整相互作用强度

